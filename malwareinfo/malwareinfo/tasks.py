from celery.decorators import periodic_task, task
from celery.task.schedules import crontab
from celery.utils.log import get_task_logger

from .models import Malware

logger = get_task_logger(__name__)

@periodic_task(run_every=(crontab(minute='*/1')), name="request_report", ignore_result=True)
def request_report():
  import time
  print(time.time(), file=open('abba.txt', 'w+'))

@task(name='test')
def test(msg):
  print(msg)
  return msg